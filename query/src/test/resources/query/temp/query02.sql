SELECT sd.CAL_DT, count(1) as cnt FROM GEOX_TRANS_MTRC_SD sd   LEFT JOIN GEOX_BYR_CNTRY_LVL_LKP lkp ON (sd.BYR_CNTRY_ID = lkp.BUYER_CNTRY_ID)   INNER JOIN (      select GEOX_TRANS_MTRC_SD.CAL_DT,  MAX(GEOX_TRANS_MTRC_SD.CAL_DT) as mm    FROM  GEOX_TRANS_MTRC_SD      LEFT JOIN  GEOX_BYR_CNTRY_LVL_LKP  ON (GEOX_TRANS_MTRC_SD.BYR_CNTRY_ID = GEOX_BYR_CNTRY_LVL_LKP.BUYER_CNTRY_ID)   GROUP BY GEOX_TRANS_MTRC_SD.CAL_DT   ORDER BY 2 DESC   LIMIT 7  ) t0 ON (sd.CAL_DT = t0.mm) GROUP BY sd.CAL_DT